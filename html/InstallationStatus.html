<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>설치 유무</title>
    <link rel="stylesheet" href="../css/renderer.css">
</head>
<body>
<div id="ing" class="padding-login background-login width-800 height-256 margin-10 padding-20" style="overflow: hidden">
    <div class="text-28 text-bold">한국거래소 대용량 데이터 다운로드 센터 다운로드 및 설치</div>
    <div class="blank-24"></div>
    <div class="text-23 text-bold">설치가 되어있는지 확인 중...</div>
</div>
<div id="install" class="padding-login background-login width-800 height-256 margin-10 padding-20 close" style="overflow: hidden">
    <div class="text-28 text-bold">한국거래소 대용량 데이터 다운로드 센터 다운로드 및 설치</div>
    <div class="blank-24"></div>
    <div class="text-23 text-bold">Windows에 한국거래소 대용량 데이터 다운로드 센터 설치하기</div>
    <div class="blank-18"></div>
    <div class="text-dotum-l">1. 대용량 데이터 다운로드 센터가 현재 pc에 설치되어 있지 않습니다.</div>
    <div class="blank-5"></div>
    <div class="text-dotum-l">2. <sapn onclick="location.href='http://git.cyber-i.com/cp/downloader/raw/master/dist/krx%20downloader%20Setup%201.0.0.exe'" class="color-lite-blue hover">설치 파일을 다운로드 합니다.</sapn></div>
    <div class="blank-5"></div>
    <div class="text-dotum-l">3. 메시지가 표시되면 실행 또는 저장을 클릭합니다.</div>
    <div class="blank-5"></div>
    <div class="text-dotum-l">4. 저장을 선택한 경우 다운로드를 더블클릭하여 설치를 시작합니다.</div>
    <div id="ieshow" class="close">
        <div class="blank-5"></div>
        <div class="text-dotum-l color-red">5. ActiveX 컨트롤 상호 작용 허용시 설치 확인이 가능합니다.</div>
    </div>
    <div id="chromshow" class="close">
        <div class="blank-5"></div>
        <div class="text-dotum-l color-red">5. 설치 확인은 Internet Explorer에서만 가능합니다.</div>
        <div class="blank-5"></div>
        <div class="text-dotum-l">6. 설치가 되어 있는 경우 <sapn onclick="run();" class="color-lite-blue hover">대용량 데이터 다운로드 센터</sapn>를 시작합니다.</div>
    </div>
</div>
<div id="run" class="padding-login background-login width-800 height-256 margin-10 padding-20 close" style="overflow: hidden">
    <div class="text-28 text-bold">한국거래소 대용량 데이터 다운로드 센터 다운로드 및 설치</div>
    <div class="blank-24"></div>
    <div class="text-23 text-bold">설치가 완료되었습니다.</div>
    <div class="blank-18"></div>
    <div class="text-dotum-l">1. <sapn onclick="run();" class="color-lite-blue hover">대용량 데이터 다운로드 센터</sapn>를 시작합니다.</div>
</div>
<!-- jqeury -->
<script src="../js/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../js/jquery/jquery-3.5.1.min.js" type="text/javascript"></script>
<script type="application/javascript">
    function run() {location.href='cyberdownload://';}

    var playAlert = setInterval(function() {
        writeInRegistry();
    }, 5000);

    function writeInRegistry() {
        try{
            new ActiveXObject("WScript.Shell").RegRead("HKEY_CLASSES_ROOT\\cyberdownload\\shell\\Open\\command\\status");
            document.getElementById('ing').classList.add('close');
            document.getElementById('install').classList.add('close');
            document.getElementById('run').classList.remove('close');
            clearInterval(playAlert);
        } catch (e) {
            document.getElementById('ing').classList.add('close');
            document.getElementById('install').classList.remove('close');
        } finally {
            ieCheck();
        }
    }

    function ieCheck() {
        var agent = navigator.userAgent.toLowerCase();
        if(!(navigator.appName == 'Netscape' && navigator.userAgent.search('Trident') != -1) || (agent.indexOf("msie") != -1)) {
            document.getElementById('chromshow').classList.remove('close');
        } else {
            document.getElementById('ieshow').classList.remove('close');
        }
    }
</script>
</body>
</html>